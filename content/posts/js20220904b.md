+++
title = "Infortrend普安GS系列存储文件同步，两台存储间文件同步"
subtitle = ""
description = "Infortrend普安GS系列存储文件同步，两台存储间文件同步"
date = 2022-09-04
author = ""
image = ""
tags =  ["存储设备","Infortrend"]
categories = ["技术笔记" ]
featured = false # 是否把本文设置为精选
+++

RSYNC: remote synchronize 的缩写，是一个远程数据同步工具，可以通过网络实现多台主机之间的文件同步，也可以实现同一主机上不同分区或目录间的数据同步。Rsync 通过“quick check”算法，仅同步发生变化的文件或目录，甚至是只同步一个文件中发生变化的内容部分。因此相比于 cp、scp 等完整拷贝工具，rsync 的增量拷贝在性能和效率上更胜一筹。

Rsync 特性：
1. 可以镜像保存整个目录树和文件系统
2. 同步时可以选择是否保持源文件或目录的权限、时间、软硬链接等属性不改变
3. 增量同步，效率更高
4. 灵活的传输方式，可以使用 rsh,ssh 或直接 socket 连接
5. 支持匿名传输

无论是本地还是远程同步数据，首次运行时将会把全部数据拷贝一次，以后再同步时才会是增量备份。由于 rsync 数据复制时效能不如 cp,tar 等工具速度快，因此如果在数据量比较大的情况下，首次复制可以先用其它工具完成，之后再用 rsync 实现同步。

GS 系列 rsync 网络服务介绍
IFT 所有统一存储，如：GS、GSe、GSc、GSa、GSi、GSe Pro 系列均可以作为 rsync 源端或 rsync 目标端或既是源端也是目标端。当使用 GS 作为 rsync 源端时，直接从“排程&备份”中创建一个文件夹远程同步计划即可；当使用 GS 作为 rsync 目标端时，由两种方式可选择，第一种方式是通过 ssh 直接访问；第二种方式是通过 socket 方式，这种方式需要先在“访问”-“网络服务”中开启并配置 rsync 目标服务，具体操作在以下章节中详细介绍。由于 rsync 协议本身是开源软件，所以此功能在 GS 中也是完全免费的，不需要额外购买 License。

两台 GS 之间 rsync 同步数据可以选择使用 ssh 方式或 socket 方式来实现，本文以SSH方式为例，演示两台GS 之间 rsync 同步数据，其中GS1016为源端，GS1012为目标端。

首先说明一下，源端：需要备份的文件设备端。目标端：备份文件的存放目标设备端。首次同步是完全同步，后面根据设置的同步计划自动增量同步。

**一、先配置目标端**

1、登录管理页面首页，“设置”—“权限”—“共享文件夹”—“添加”，新建一个共享文件夹，按下图勾选协议。

![](/img/2fc0582362a24512c2e2050553031278.png)

2、设置共享文件夹参数，按照下图设置

![](/img/bad0e56dbc5af853f36b31b1b9452aaa.png)

3、给相应用户读写权限

![](/img/ae74c20f5d563780bc44d9a7c1ce7679.png)

4、目标端配置完成

![](/img/4474e5495fe6b0ddc90e9e54f5f7cb18.png)

**二、配置源端**

1、“设置”—“排程备份”—“任务列表”--“创建计划”

![](/img/cc540b9a21105387770e79b0f5723257.png)

2、“创建文件夹远程同步计划”

![](/img/de3f3c48685e9b616633f0c9cacaa6a5.png)

3、设置源文件夹和传输通道

![](/img/b4c89165d2df23b034227c8dcdd97d11.png)

4、配置同步到目标文件夹的参数

![](/img/4b81c44a9ae9414d45a079edba013130.png)

上面的“目标目录名称”填写目标端文件夹的绝对路径，可以在目标端的文件夹信息中查看，如下图

![](/img/1195ec364fdf6d521b8c1e2695d2f10c.png)

5、创建计划的排程，按实际需求来选择

![](/img/3f19553ea25d86a341e404ae47598a0e.png)

![](/img/13ed28cfd6a6323962a67f1159cdb24a.png)

计划创建完成后，在同步计划任务列表中，即可查看到刚刚建立的计划

![](/img/e1bb068720650ef5bc3af7ecf6f9a3c8.png)

![](/img/41188b01e64e991d851349e35a1f37cd.png)

三、同步完成后，可以对比源文件夹与目标文件夹的容量大小，看是否一致，如下面两个图，源文件夹与目标文件夹的容量是一致的。如果容量不一致，可能是同步未完成，要继续等待，然后隔一段时间查看下目标文件夹的容量是否比前一次查看的容量有所增加。

![](/img/d96eca1a11207d051f62bf51d5d909ea.png)

![](/img/bd1d5c06b422e0aab1d737af68fdf4c3.png)

若某个计划的同步状态显示失败，要重新检查上面的每一个步骤是否设置正确，或者把原计划删除，再重新建一个计划。
